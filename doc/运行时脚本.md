# 运行时脚本

## 1 介绍

在剧情指令与触发器中，由于许多地方需要使用逻辑判断，因此Next引入了一个C#动态解析库来进行逻辑判断。

编写脚本指令时，可以把脚本指令看作类似于
```C#
var result = xxxx;
```
xxxx即是脚本指令。

例如，在触发器判断中，condition需要返回值为bool的指令，则可以写出如下脚本指令
```C#
roleBindID==609
```
通过判断目标Npc的绑定ID是否为609来决定是否触发。

而在剧情指令SetChar中，需要返回值为int的指令，则可以直接使用
```C#
roleID
```
来返回当前交谈NPC的ID

## 2 脚本环境

脚本在运行时会有一个默认的环境对象，脚本可以直接调用环境里的字段与方法。

当前环境定义的字段与方法如下：

### 2.1 字段
|字段名|类型|说明|
|-|-|-|
|roleID|int|环境角色的实时ID|
|roleBindID|int|环境角色绑定的ID<br/>参考`AvatarJsonData.json`|
|roleName|string|角色名称|
|bindNpc|UINPCData<br/>参考Dump的[文件](UINpcData.cs)|用于查询的角色数据|

### 2.2 方法
|方法定义|说明|
|-|-|
|int GetInt(string key)|key : 键<br/><br/>从id为key的键中取出值。<br>实际储存位置储存于角色数据的`AvatarChengJiuData`|